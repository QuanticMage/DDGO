<div class="searchwrapper">
    <div class="searchbar">
        <span class="searchbar_icon" aria-hidden="true">🔎</span>

        <input class="searchbar_input"
               type="search"
               placeholder="Custom search…"
               @bind="_current"
               @bind:event="oninput"
               @onkeydown="HandleKeyDown"
               @onkeydown:preventDefault="_preventDefault" />
    </div>
</div>

@code {
    [Parameter] public string Value { get; set; } = "";
    [Parameter] public EventCallback<string> ValueChanged { get; set; }

    private string _current = "";
    private bool _preventDefault = false;

    protected override void OnParametersSet()
    {
        // ONLY sync if the parent is passing a non-empty string
        // that is different from what we have.
        if (!string.IsNullOrEmpty(Value) && Value != _current)
        {
            _current = Value;
        }
    }

    private async Task HandleKeyDown(KeyboardEventArgs e)
    {
        if (e.Key == "Enter")
        {
            _preventDefault = true;
            await ValueChanged.InvokeAsync(_current);
        }
        else
        {
            _preventDefault = false;
        }
    }
}